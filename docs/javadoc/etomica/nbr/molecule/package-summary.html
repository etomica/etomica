<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>etomica.nbr.molecule</title>
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="etomica.nbr.molecule";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../etomica/nbr/list/molecule/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../etomica/nbr/site/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?etomica/nbr/molecule/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;etomica.nbr.molecule</h1>
<div class="docSummary">
<div class="block">Provides classes that implement neighbor-listing capabilities.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../etomica/nbr/molecule/NeighborCriterionMolecular.html" title="interface in etomica.nbr.molecule">NeighborCriterionMolecular</a></td>
<td class="colLast">
<div class="block">Atom filter used to specify whether two atoms are considered neighbors,
 for the purpose of tabulating neighbor lists.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../etomica/nbr/molecule/CriterionAdapterMolecular.html" title="class in etomica.nbr.molecule">CriterionAdapterMolecular</a></td>
<td class="colLast">
<div class="block">Wraps another criterion while adding additional criteria to the acceptance
 decision.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../etomica/nbr/molecule/CriterionAllMolecular.html" title="class in etomica.nbr.molecule">CriterionAllMolecular</a></td>
<td class="colLast">
<div class="block">Specifies that all atoms pairs are to be considered neighbors.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../etomica/nbr/molecule/CriterionSimpleMolecular.html" title="class in etomica.nbr.molecule">CriterionSimpleMolecular</a></td>
<td class="colLast">
<div class="block">Simple neighbor criterion based on distance between the two molecules 
 If the molecule moves further than r^2; the update method will kick in
 to update the neighborlist.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../etomica/nbr/molecule/CriterionSpecies.html" title="class in etomica.nbr.molecule">CriterionSpecies</a></td>
<td class="colLast">
<div class="block">Filters molecule to match a given species.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../etomica/nbr/molecule/CriterionSpeciesPair.html" title="class in etomica.nbr.molecule">CriterionSpeciesPair</a></td>
<td class="colLast">
<div class="block">Filters molecule pairs to match a given pair of Species.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../etomica/nbr/molecule/PotentialMasterNbrMolecular.html" title="class in etomica.nbr.molecule">PotentialMasterNbrMolecular</a></td>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package etomica.nbr.molecule Description">Package etomica.nbr.molecule Description</h2>
<div class="block">Provides classes that implement neighbor-listing capabilities.  Neighbor-listing is
an efficiency used to speed the calculation of the interatomic interactions.  With it,
each atom carries with it a list of all the other atoms that are currently
close enough to it to be considered "neighbors", and thus to interact with it.  The neighbor
list must be regularly updated as the atoms move around.

To enable neighbor listing:
<ol>
<li>Provide an instance of PotentialMasterNbr as an argument to the Simulation constructor.  
<li>Specify the criterion that defines "neighbors", if not using the default criterion. 
The neighbor criterion can be specified separately for each potential, and is 
accomplished via the setSpecies method of the PotentialMasterNbr instance. 
<li>Register the neighborManager of the PotentialMasterNbr instance as a listener with 
all Integrators used in the simulation (the neighbor manager can be accessed via the
getNeighborManager method of PotentialMasterNbr).
</ol>
<p>
Neighbor-list facility is implemented as follows.  Neighbor lists are held
by the atom's sequencer (AtomSequencerNbr).  Lists are keyed to the potential,
so given an atom it is possible to iterate over all 
current neighbors interacting
with it via a particular potential.  Such lists are kept only for "real" potentials,
not potential groups.  PotentialMaster constructs a NeighborManager, which needs to listen
for interval events, and must therefore be registered with all integrators as
an interval listener. The neighborManager is responsible for keeping the neighbor
lists up to date. The NeighborCriterion interface includes methods that allow it to flag whether an atom has
moved sufficiently far to require that its neighbor list be updated.  
With each interval event it loops through all atoms and checks 
whether any of the neighbor criteria associated with each indicates that its neighbor list
needs updating.  If this situation 
is observed for one atom, the neighbor lists of all atoms are updated (with the idea that
they will very soon need to be updated even if they are currently ok).  
<p>
Once specified via the setSpecies method, NeighborCriterion instances are recorded
in three places.
<ul>
<li> Each criterion is held by this NeighborManager, which keeps a master list only to
  be able to setBox for all of them when an update is initiated.  
<li> Each criterion is also kept by the AtomType of each atom (using a NeighborManagerAgent
  field held by each AtomType instance), and these are used to 
  identify all criteria applying to an atom when checking if neighbor updates are needed.
<li> Each criterion is used to wrap a AtomIteratorFiltered instance around the 
  iterator for the potential, so that any atom pairs yielded by the iterator are, by
  definition, neighbors.
</ul>
<br>
There is also a calculate method in PotentialMasterNbr that takes specifically a 
PotentialCalculationNbrSetup instance.  If this is invoked, the full potential
hierarchy is traversed, and any pair of atoms given to the potential calculation will
have each put on the other's neighbor list -- any pairs given to it are by definition
"neighbors".  Pairs are weeded out before reaching the neighbor-setup potential calculation
in two ways:
<ul>
<li>A cell-based neighbor list is established automatically with the neighbor-list
facility, so an atom pair will be formed only if the atoms are in molecules that 
the cell-list gives as neighbors
<li>The NeighborCriterion associated with the potential filters out any pair that
do not meet the criterion's definition of "neighbors".
</ul>
For those atoms identified as neighbors, the calculate method of PotentialMasterNbr 
(the one not defined specifically for PotentialCalculationNbrSetup) is configured 
to perform neighbor-list iteration
directly -- the iterator for forming pairs of neighboring atoms is defined inside of
PotentialMasterNbr.  It performs neighbor iteration for any (leaf or group) atom that has
a non-zero list of potentials applying to it.  This will happen if the atom has
any concrete (non-group) potential acting on it (concrete potentials are sometimes defined
for atom groups, not just leaf atoms).


to update the neighbor lists if invoked with
a PotentialCalculationNbrSetup instance.
 
<!--

<h2>Package Specification</h2>

##### FILL IN ANY SPECS NEEDED BY JAVA COMPATIBILITY KIT #####
<ul>
  <li><a href="">##### REFER TO ANY FRAMEMAKER SPECIFICATION HERE #####</a>
</ul>

<h2>Related Documentation</h2>

For overviews, tutorials, examples, guides, and tool documentation, please see:
<ul>
  <li><a href="">##### REFER TO NON-SPEC DOCUMENTATION HERE #####</a>
</ul>
-->
<!-- Put @see and @since tags down here. --></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../etomica/nbr/list/molecule/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../etomica/nbr/site/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?etomica/nbr/molecule/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
